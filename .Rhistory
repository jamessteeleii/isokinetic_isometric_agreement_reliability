exercise == "lp" ~ "Leg Press",
exercise == "row" ~ "Row"
)) |>
ggplot() +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(data = loamr_summary_isometric,
aes(x=mean_i, ymin = .lower, ymax = .upper, group=coef),
alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = loamr_summary_isometric$loam_w_days.lower, ymax = loamr_summary_isometric$loam_w_days.upper,
#          alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = -loamr_summary_isometric$loam_w_days.lower, ymax = -loamr_summary_isometric$loam_w_days.upper,
#          alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = loamr_summary_isometric$loam_bw_days.lower, ymax = loamr_summary_isometric$loam_bw_days.upper,
#          alpha = 0.5, fill = "#56B4E9") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = -loamr_summary_isometric$loam_bw_days.lower, ymax = -loamr_summary_isometric$loam_bw_days.upper,
#          alpha = 0.5, fill = "#56B4E9") +
#
# geom_hline(yintercept = c(-loamr_summary_isometric$loam_w_days,loamr_summary_isometric$loam_w_days), linetype = "dotted") +
# geom_hline(yintercept = c(-loamr_summary_isometric$loam_bw_days,loamr_summary_isometric$loam_bw_days)) +
# geom_label(data = isometric_data |> group_by(participant) |> slice_max(mean_diff, n=1),
#            aes(x = mean_i, y = mean_diff + 10, label = participant)) +
geom_point(aes(x=mean_i, y=mean_diff), size = 2, color = "black", fill = NA, shape = 21, alpha = 0.75) +
geom_point(aes(x=mean_i, y=mean_diff, color=day), alpha = 0.75) +
scale_color_viridis_d() +
scale_y_continuous(breaks = seq(-100, 100, by=25)) +
facet_wrap(~exercise, scales = "free") +
labs(
# title = "Chest Press Exercise",
# subtitle = glue::glue("Within-day trial to trial limits of agreement: +/- {round(loamr_summary_isometric$loam_w_days,2)} [95% QI: {round(loamr_summary_isometric$loam_w_days.lower,2)},{round(loamr_summary_isometric$loam_w_days.upper,2)}]\nBetween-day trial to trial limits of agreement: +/- {round(loamr_summary_isometric$loam_bw_days,2)} [95% QI: {round(loamr_summary_isometric$loam_bw_days.lower,2)},{round(loamr_summary_isometric$loam_bw_days.upper,2)}]"),
x = expression(bar(y)[i..]),
y = expression(y[ijk]-bar(y)[i..]),
color = "Day"
) +
theme_bw()
loamr_summary_isometric <- draws_isometric |>
select(cp_loam_bw_days, cp_loam_w_days, lp_loam_bw_days, lp_loam_w_days, row_loam_bw_days, row_loam_w_days) |>
pivot_longer(1:6,
names_to = "coef",
values_to = "mean") |>
group_by(coef) |>
mean_qi() |>
faux::add_within("coef", mean_i = seq(min(isometric_data$mean_i)*0.95, max(isometric_data$mean_i)*1.05, length = 100))
isometric_data |>
mutate(exercise = case_when(
exercise == "cp" ~ "Chest Press",
exercise == "lp" ~ "Leg Press",
exercise == "row" ~ "Row"
)) |>
ggplot() +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(data = loamr_summary_isometric,
aes(x=mean_i, ymin = .lower, ymax = .upper, group=coef),
alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = loamr_summary_isometric$loam_w_days.lower, ymax = loamr_summary_isometric$loam_w_days.upper,
#          alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = -loamr_summary_isometric$loam_w_days.lower, ymax = -loamr_summary_isometric$loam_w_days.upper,
#          alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = loamr_summary_isometric$loam_bw_days.lower, ymax = loamr_summary_isometric$loam_bw_days.upper,
#          alpha = 0.5, fill = "#56B4E9") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = -loamr_summary_isometric$loam_bw_days.lower, ymax = -loamr_summary_isometric$loam_bw_days.upper,
#          alpha = 0.5, fill = "#56B4E9") +
#
# geom_hline(yintercept = c(-loamr_summary_isometric$loam_w_days,loamr_summary_isometric$loam_w_days), linetype = "dotted") +
# geom_hline(yintercept = c(-loamr_summary_isometric$loam_bw_days,loamr_summary_isometric$loam_bw_days)) +
# geom_label(data = isometric_data |> group_by(participant) |> slice_max(mean_diff, n=1),
#            aes(x = mean_i, y = mean_diff + 10, label = participant)) +
geom_point(aes(x=mean_i, y=mean_diff), size = 2, color = "black", fill = NA, shape = 21, alpha = 0.75) +
geom_point(aes(x=mean_i, y=mean_diff, color=day), alpha = 0.75) +
scale_color_viridis_d() +
scale_y_continuous(breaks = seq(-100, 100, by=25)) +
facet_wrap(~exercise, scales = "free") +
labs(
# title = "Chest Press Exercise",
# subtitle = glue::glue("Within-day trial to trial limits of agreement: +/- {round(loamr_summary_isometric$loam_w_days,2)} [95% QI: {round(loamr_summary_isometric$loam_w_days.lower,2)},{round(loamr_summary_isometric$loam_w_days.upper,2)}]\nBetween-day trial to trial limits of agreement: +/- {round(loamr_summary_isometric$loam_bw_days,2)} [95% QI: {round(loamr_summary_isometric$loam_bw_days.lower,2)},{round(loamr_summary_isometric$loam_bw_days.upper,2)}]"),
x = expression(bar(y)[i..]),
y = expression(y[ijk]-bar(y)[i..]),
color = "Day"
) +
theme_bw()
isometric_data |>
mutate(exercise = case_when(
exercise == "cp" ~ "Chest Press",
exercise == "lp" ~ "Leg Press",
exercise == "row" ~ "Row"
)) |>
ggplot() +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(data = loamr_summary_isometric,
aes(x=mean_i, ymin = .lower, ymax = .upper, group=coef),
alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = loamr_summary_isometric$loam_w_days.lower, ymax = loamr_summary_isometric$loam_w_days.upper,
#          alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = -loamr_summary_isometric$loam_w_days.lower, ymax = -loamr_summary_isometric$loam_w_days.upper,
#          alpha = 0.75, fill = "#E69F00") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = loamr_summary_isometric$loam_bw_days.lower, ymax = loamr_summary_isometric$loam_bw_days.upper,
#          alpha = 0.5, fill = "#56B4E9") +
# annotate("rect", xmin = -Inf, xmax = Inf,
#          ymin = -loamr_summary_isometric$loam_bw_days.lower, ymax = -loamr_summary_isometric$loam_bw_days.upper,
#          alpha = 0.5, fill = "#56B4E9") +
#
# geom_hline(yintercept = c(-loamr_summary_isometric$loam_w_days,loamr_summary_isometric$loam_w_days), linetype = "dotted") +
# geom_hline(yintercept = c(-loamr_summary_isometric$loam_bw_days,loamr_summary_isometric$loam_bw_days)) +
# geom_label(data = isometric_data |> group_by(participant) |> slice_max(mean_diff, n=1),
#            aes(x = mean_i, y = mean_diff + 10, label = participant)) +
geom_point(aes(x=mean_i, y=mean_diff), size = 2, color = "black", fill = NA, shape = 21, alpha = 0.75) +
geom_point(aes(x=mean_i, y=mean_diff, color=day), alpha = 0.75) +
scale_color_viridis_d() +
scale_y_continuous(breaks = seq(-100, 100, by=25)) +
ggh4x::facet_grid2(exercise~., scales = "free", independent = "x") +
labs(
# title = "Chest Press Exercise",
# subtitle = glue::glue("Within-day trial to trial limits of agreement: +/- {round(loamr_summary_isometric$loam_w_days,2)} [95% QI: {round(loamr_summary_isometric$loam_w_days.lower,2)},{round(loamr_summary_isometric$loam_w_days.upper,2)}]\nBetween-day trial to trial limits of agreement: +/- {round(loamr_summary_isometric$loam_bw_days,2)} [95% QI: {round(loamr_summary_isometric$loam_bw_days.lower,2)},{round(loamr_summary_isometric$loam_bw_days.upper,2)}]"),
x = expression(bar(y)[i..]),
y = expression(y[ijk]-bar(y)[i..]),
color = "Day"
) +
theme_bw()
targets::tar_load(isometric_data, isokinetic_data)
targets::tar_load(c(isometric_data, isokinetic_data))
isometric_data_wide <- isometric_data |>
select(participant, exercise, day, trial, value) |>
pivot_wider(names_from = "exercise",
values_from = "value",
id_cols = c("participant", "day", "trial"))
library(tidyverse)
library(here)
library(janitor)
library(loamr)
library(patchwork)
library(rstan)
library(brms)
library(tidybayes)
isometric_data_wide <- isometric_data |>
select(participant, exercise, day, trial, value) |>
pivot_wider(names_from = "exercise",
values_from = "value",
id_cols = c("participant", "day", "trial"))
Y <- as.matrix(isometric_data_wide[,c("cp","lp","row")])
im_mod <- lme4::lmer(Y ~ + day + (1|participant) + (1|participant:day),
data = isometric_data_wide)
im_mod <- lme4::lmer(Y ~ 1 + day + (1|participant) + (1|participant:day),
data = isometric_data_wide)
Y <- as.matrix(isokinetic_data[,c("delta_cp_con","delta_lp_con","delta_row_con",
"delta_cp_ecc","delta_lp_ecc","delta_row_ecc")])
ik_mod <- lm(Y ~ 1,
data = isokinetic_data)
ik_mod
install.packages("equatiomatic")
equatiomatic::extract_eq(ik_mod)
equatiomatic::extract_eq("ik_mod")
equatiomatic::extract_eq(ik_mod)
targets::tar_load(c(isometric_model, isokinetic_model))
VarCorr(isometric_model)
vcov(isometric_model)
vcov(isometric_model)
vcov(isometric_model, correlation = TRUE)
VarCorr(isometric_model, summary = TRUE)
isometric_model
isokinetic_model
vcov(isokinetic_model)
vcov(isokinetic_model, correlation = TRUE)
residuals(isometric_model)
isometric_residuals <- residuals(isometric_model)
cor(isometric_residuals)
cor(isometric_residuals[1], isometric_residuals[2])
Y <- as.matrix(isokinetic_data[,c("delta_cp_con","delta_lp_con","delta_row_con",
"delta_cp_ecc","delta_lp_ecc","delta_row_ecc")])
isometric_residuals[1]
isometric_residuals[[1]]
isometric_model
isometric_residuals <- as_tibble(isometric_residuals)
View(isometric_residuals)
cor(isometric_residuals$Estimate.cp, isometric_residuals$Estimate.lp)
ranef(isometric_model)
isometric_ranef <- ranef(isometric_model)
isometric_ranef <- as_tibble(ranef(isometric_model))
View(isometric_ranef)
isometric_ranef$`participant:day`
isometric_ranef <- as_tibble(ranef(isometric_model)$`participant:day`)
cor(isometric_ranef$Estimate.cp_Intercept, isometric_ranef$Estimate.lp_Intercept)
im_mod <- lme4::lmer(cp ~ 1 + day + (1|participant) + (1|participant:day),
data = isometric_data_wide)
equatiomatic::extract_eq(ik_mod)
equatiomatic::extract_eq(im_mod)
im_mod <- lme4::lmer(cp ~ 1 + day + (day|participant) + (1|participant:day),
data = isometric_data_wide)
equatiomatic::extract_eq(im_mod)
im_mod <- lme4::lmer(cp ~ 1 + day + (1|participant) + (1|participant:day),
data = isometric_data_wide)
equatiomatic::extract_eq(im_mod)
get_prior(isometric_model)
targets::tar_load(isometric_data)
im_mod <- lme4::lmer(cp ~ 1 + day + (1|participant) + (1|participant:day),
data = isometric_data_wide)
im_mod
equatiomatic::extract_eq(im_mod)
isometric_model
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
im_mod <- lme4::lmer(cp ~ 1 + day + (1 + day|participant),
data = isometric_data_wide)
equatiomatic::extract_eq(im_mod)
isometric_model
View(isometric_ranef)
install.packages("ggcorrplot")
round(cor(isometric_ranef[,c(1,5,9)]))
round(cor(isometric_ranef[,c(1,5,9)]),2)
bayes_R2(isometric_model)
pp_check(isometric_model)
pp_check(isometric_model, resp = "cp")
pp_check(isometric_model, resp = "lp")
pp_check(isometric_model, resp = "row")
pp_check(isometric_model, resp = "all")
isokinetic_model
VarCorr(isokinetic_model)
vcov(isokinetic_model)
vcov(isokinetic_model, correlation = TRUE)
vcov(isokinetic_model, correlation = TRUE)
get_prior((isometric_model))
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
sqrt((10/1000^2) + (10/1000^2))
sqrt((10^2/1000) + (10^2/1000))
(10 - 0 ) / sqrt((10^2/1000) + (10^2/1000))
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
(10 - 0 ) / sqrt((10^2/1000) + (10^2/1000))
x <- rnorm(100, 0, 10)
y <- rnorm(100, 10, 10)
z <- y-x
sd(z)
x <- rnorm(100, 0, 10)
y <- rnorm(100, 10, 10)
z <- y-x
sd(z)
x <- rnorm(100, 0, 10)
y <- rnorm(100, 10, 10)
z <- y-x
sd(z)
(10 - 0 ) / sqrt((sd(x)^2/100) + (sd(y)^2/1000))
x <- rnorm(100, 0, 10)
y <- rnorm(100, 10, 10)
z <- y-x
sd(z)
(10 - 0 ) / sqrt((sd(x)^2/100) + (sd(y)^2/100))
x <- rnorm(100, 0, 10)
y <- x + rnorm(100, 10, 10)
z <- y-x
sd(z)
x <- rnorm(100, 0, 10)
y <- x + rnorm(100, 10, 10)
z <- y-x
sd(z)
x <- rnorm(1000, 0, 10)
y <- x + rnorm(1000, 10, 10)
z <- y-x
sd(z)
(10 - 0 ) / sqrt((sd(x)^2/100) + (sd(y)^2/100))
sqrt(sd(x)^2 + sd(y)^2)
sd(z)
x <- rnorm(1000, 0, 10)
y <- x + rnorm(1000, 10, 10)
z <- y-x
sd(z)
sqrt(sd(x)^2 + sd(y)^2)
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
sqrt(sd(x)^2 + sd(y)^2)
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
sqrt(sd(x)^2 + sd(y)^2)
mean(isometric_data_wide$cp)
mean(isometric_data_wide$lp)
mean(isometric_data_wide$row)
get_prior(isometric_model)
sd(isometric_data_wide$cp)
sd(isometric_data_wide$lp)
sd(isometric_data_wide$row)
sd(subset(isometric_data_wide, day == 1 & trial == 1)$cp)
sd(isometric_data_wide$row)
subset(isometric_data_wide, day == 1 & trial == 1)
View(isometric_data_wide)
sd(subset(isometric_data_wide, day == "1" & trial == "1")$cp)
subset(isometric_data_wide, day == "1" & trial == "1")
sd(subset(isometric_data_wide, day == "d1" & trial == "1")$cp)
View(isometric_data_wide)
sd(subset(isometric_data_wide, day == "d1" & trial == "t1")$cp)
mean_cp <- mean(isometric_data_wide$cp)
mean_lp <- mean(isometric_data_wide$lp)
mean_row <- mean(isometric_data_wide$row)
sd_cp <- sd(isometric_data_wide$cp)
sd_lp <- sd(isometric_data_wide$lp)
sd_row <- sd(isometric_data_wide$row)
prior <- c(
set_prior(paste("student_t(3,", mean_cp,",", sd_cp,")"), class = "b", resp = "cp"),
set_prior(paste("student_t(3,", mean_lp,",", sd_lp,")"), class = "b", resp = "lp"),
set_prior(paste("student_t(3,", mean_row,",", sd_row,")"), class = "b", resp = "row")
)
prior
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
sqrt(sd(x)^2 + sd(y)^2)
x <- rnorm(1000, 0, 10)
y <- rnorm(1000, 10, 10)
z <- y-x
sd(z)
x <- rnorm(1e6, 0, 10)
y <- rnorm(1e6, 10, 10)
z <- y-x
sd(z)
sqrt(sd(x)^2 + sd(y)^2)
x <- rnorm(1e6, 0, 10)
y <- rnorm(1e6, 10, 10)
z <- y-x
sd(z)
sqrt(sd_cp^2 + sd_cp^2)
2*sqrt(sd_cp^2)
sqrt(2*sd_cp^2)
mean_cp*0.2
get_prior(isometric_model)
var(z)
sqrt(2*sd_cp^2)
sqrt(2*var(z))
var(z)
?var
var(z)
sd(z)^
var(z)
sd(z)^2
sqrt(2*var(z))
sqrt(2*sd(z)^2)
(1/1e6-1)*var(z)
1/1e6-1
((1/(1e6-1))*sum(z-mean(z))
((1/(1e6-1))*sum(z-mean(z)))
((1/(1e6-1))*sum(z-mean(z)))
((1/(1e6-1))*sum(z-mean(z)^2))
((1/(1e6-1))*sum(z-mean(z))^2)
sqrt(((1/(1e6-1))*sum(z-mean(z))^2))
squared_errors <- z-mean(z)
squared_errors <- (z-mean(z))^2
squared_errors <- (z-mean(z))^2
sum(squared_errors)/(1e6-1)
(1/(1e6-1))*sum(squared_errors)
sd(z)^2
var(z)
2*sqrt(10^2)
targets::tar_make()
install.packages("grateful")
targets::tar_make()
get_prior(isometric_model)
targets::tar_make()
targets::tar_make()
pp_check(isometric_model, resp = c("cp","lp"))
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
get_prior(isokinetic_model)
#| message: false
#| warning: false
#| echo: false
targets::tar_load(isometric_model)
targets::tar_load(isometric_bias_summary)
targets::tar_load(isometric_loamr_summary)
isometric_bias_summary
isometric_loamr_summary
isometric_loamr_summary |>
group_by(exercise) |>
slice(n=1)
isometric_loamr_summary |>
group_by(exercise) |>
slice_head(n=1)
targets::tar_make()
install.packages("quarto")
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
isometric_bias_summary
isometric_loamr_summary
isometric_loamr_summary <- isometric_loamr_summary |>
group_by(exercise) |>
slice_head(n=1)
isometric_loamr_summary
isometric_loamr_summary$mean[1]
#| message: false
#| warning: false
#| echo: false
#| label: fig-isometric-plot
#| fig-width: 10
#| fig-height: 6.66
#| fig-cap: Bias and limits of agreement with the mean for isometric outcomes for both between- and within-day.
targets::tar_load(combined_isometric_plot)
combined_isometric_plot
#| message: false
#| warning: false
#| echo: false
targets::tar_load(isokinetic_model)
targets::tar_load(isokinetic_bias_summary)
targets::tar_load(isokinetic_loamr_summary)
isokinetic_loamr_summary <- isokinetic_loamr_summary |>
group_by(exercise) |>
slice_head(n=1)
isokinetic_loamr_summary
targets::tar_load(isokinetic_model)
targets::tar_load(isokinetic_loa_summary)
isokinetic_loamr_summary <- isokinetic_loa_summary |>
group_by(exercise) |>
slice_head(n=1)
isokinetic_loa_summary <- isokinetic_loa_summary |>
group_by(exercise) |>
slice_head(n=1)
isokinetic_loa_summary
targets::tar_load(isokinetic_bias_loa_summary)
isokinetic_bias_loa_summary
isokinetic_bias_loa_summary |>
group_by(exercise) |>
slice_head(n=1)
isometric_loamr_summary |>
group_by(exercise, bw) |>
slice_head(n=1)
targets::tar_load(isometric_loamr_summary)
isometric_loamr_summary |>
group_by(exercise, bw) |>
slice_head(n=1)
isometric_loamr_summary
isometric_loamr_summary |>
group_by(exercise, bw_w) |>
slice_head(n=1)
targets::tar_load(isometric_loamr_summary)
isometric_loamr_summary_bw <- isometric_loamr_summary |>
filter(bw_w == "bw")
group_by(exercise) |>
slice_head(n=1)
targets::tar_load(isometric_loamr_summary)
isometric_loamr_summary_bw <- isometric_loamr_summary |>
filter(bw_w == "bw") |>
group_by(exercise) |>
slice_head(n=1)
isometric_loamr_summary_w <- isometric_loamr_summary |>
filter(bw_w == "w") |>
group_by(exercise) |>
slice_head(n=1)
isometric_loamr_summary_bw
isometric_loamr_summary_w
isometric_loamr_summary_w$mean[1]
isokinetic_bias_loa_summary_con <- isokinetic_bias_loa_summary |>
filter(con_ecc == "Concentric")
isokinetic_bias_loa_summary_ecc <- isokinetic_bias_loa_summary |>
filter(con_ecc == "Eccentric")
isokinetic_bias_loa_summary_con
targets::tar_load(isokinetic_bias_loa_summary)
isokinetic_bias_loa_summary_con <- isokinetic_bias_loa_summary |>
filter(con_ecc == "Concentric") |>
group_by(exercise) |>
slice_head(n=1)
isokinetic_bias_loa_summary_ecc <- isokinetic_bias_loa_summary |>
filter(con_ecc == "Eccentric") |>
group_by(exercise) |>
slice_head(n=1)
isokinetic_bias_loa_summary_ecc
#| message: false
#| warning: false
#| echo: false
#| label: fig-isokinetic-plot
#| fig-width: 10
#| fig-height: 6.66
#| fig-cap: Between day bias and limits of agreement for isokinetic outcomes.
targets::tar_load(isokinetic_BA_plot)
isokinetic_BA_plot
